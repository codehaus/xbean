<?xml version="1.0" encoding="UTF-8"?>
<!--
* Copyright 2005 the original author or authors.
*
*  Licensed under the Apache License, Version 2.0 (the "License");
*  you may not use this file except in compliance with the License.
*  You may obtain a copy of the License at
*
*     http://www.apache.org/licenses/LICENSE-2.0
*
*  Unless required by applicable law or agreed to in writing, software
*  distributed under the License is distributed on an "AS IS" BASIS,
*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
*  See the License for the specific language governing permissions and
*  limitations under the License.
-->
<project default="default" xmlns:j="jelly:core" xmlns:ant="jelly:ant">

  <postGoal name="test:compile">
    <attainGoal name="xbean:generate"/>
  </postGoal>

  <goal name="default">
    <attainGoal name="jar:install"/>
  </goal>

  <goal name="build">
    <attainGoal name="default"/>
  </goal>

  <goal name="rebuild">
    <attainGoal name="clean"/>
    <attainGoal name="build"/>
  </goal>

  <goal name="xbean:generate" description="Generates the XBean XSD, documentation and META-INF/services files.">
    <taskdef name="mapping" classname="org.xbean.spring.generator.MappingGeneratorTask">
      <classpath>
        <pathelement path="${maven.build.dest}"/>
        <pathelement path="${maven.test.dest}"/>
        <path refid="maven.dependency.classpath"/>
      </classpath>
    </taskdef>

    <mapping destFile="target/restaurant.xsd"
      namespace="http://xbean.org/schemas/pizza"
      srcdir="src/test"
      metaInfDir="${basedir}/target/generated/"/>

    <copy todir="${basedir}/target/test-classes">
      <fileset dir="${basedir}/target/generated"/>
    </copy>
  </goal>
</project>
